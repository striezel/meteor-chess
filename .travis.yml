language: node_js
node_js:
  - "8"
# We need sudo to create the global meteor script in /usr/bin/meteor during
# the installation of Meteor.
sudo: true
dist: trusty
cache:
  directories:
    - ".meteor"
addons:
  apt:
    packages:
    - g++-4.8
    - gcc-4.8
    - git
    - cmake
    - catch
    - libglib2.0-dev
    - libjsoncpp-dev
    - libmongo-client-dev
before_install:
  - export CXX="g++-4.8" CC="gcc-4.8"
install:
  # Install Meteor globally.
  - pwd
  - curl https://install.meteor.com/ | sh
  # Build meteor-chess-client with gcc.
  - cd
  - git clone https://github.com/striezel/simple-chess.git
  - cd simple-chess
  - mkdir ./b
  - cd ./b
  - cmake ..
  # Build only meteor-chess-client and not the other executables.
  - make -j2 meteor-chess-client
  # change back to build directory of meteor-chess
  - cd "$TRAVIS_BUILD_DIR"
  - pwd
script:
  - cd meteorapp
  - meteor npm install
  - ./tests.sh
# notifications:
#   email: false
